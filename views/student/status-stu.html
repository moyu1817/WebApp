<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReservU</title>
    <link rel="icon" type="image/png" href="/public/img/reservU-logo-favicon.png">
  

  <!-- Font -->

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap"
    rel="stylesheet">

  <!-- Bootstrap core CSS -->
  <link href="/public/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="/public/bootstrap/css/bootstrap.min.css">


  <!-- font awesome css-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <!-- Additional CSS Files for template Design -->
  <link rel="stylesheet" href="/public/css/reservU.css">
  <link rel="stylesheet" href="/public/css/animated.css">
  <link rel="stylesheet" href="/public/css/owl.css">

  <!-- Css for info -->
  <link rel="stylesheet" href="/public/css/style.css">

  <style>
    body {
        background-image: url(/public/img/background-star2.jpg);
        background-size: cover;
    }
</style>

<style>
  body {
      background-image: url(/public/img/background-star2.jpg);
      background-size: cover;
  }

  .container-stu {
      margin-top: 70px;
  }

  .card {
      background-color: #121835;
      color: white;
      margin-bottom: 20px;
      border-radius: 10px;
      border: none;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  .card-img-top {
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
  }

  .card-body {
      padding: 20px;
  }

  .card-title {
      color: white;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 15px;
  }

  .card-text {
      color: white;
      font-size: 16px;
      margin-bottom: 10px;
  }

  .status-badge {
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 14px;
      font-weight: bold;
  }

  .status-title {
      margin-top: 100px;
      background-color: #008DC3;
      color: white;
      padding: 10px;
      margin-bottom: 10px;
  }

  .footer {
display: flex;
justify-content: space-between;
align-items: center;
position: fixed;
bottom: 0;
left: 0;
width: 100%;
background-color: #121835;
color: white;
padding: 10px;
box-sizing: border-box;
}

#pageInfo,
#totalPages {
margin: 0;
}

#totalPages {
margin-left: 10px; /* Adjust margin-left for spacing */
}


  .pagination-container {
      margin-top: 20px;
      display: flex;
      justify-content: center;
  }

  .pagination-button {
      margin: 0 5px;
      cursor: pointer;
      background-color: #008DC3;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
  }

  .pagination-button:hover {
      background-color: #005f82;
  }

  .pagination-button.disabled {
      opacity: 0.5;
      cursor: not-allowed;
  }
  #colorpending {
background-color: #f4eaa9;
color: #969302;
}

#colorapproved {
background-color: #a8f4c4;
color: #247203;
}

#colorrejected {
background-color: #f4a8b3;
color: #5a0808;
}
</style>

</head>

<body>

  <!-- ***** Header Area Start ***** -->

  <header class="header-area header-area-main-page header-sticky wow slideInDown" data-wow-duration="0.75s" data-wow-delay="0s">
    <div class="container" >
      <div class="row">
        <div class="col-12">
          <nav class="main-nav">
            <!-- ***** Logo Start ***** -->
            <a href="/student/student-status" class="logo">
              <img src="/public/img/logo.png" width="300px" alt="ReservU">
            </a>
            <!-- ***** Logo End ***** -->
            <!-- ***** Menu Start ***** -->
            <ul class="nav">
                <li><a href="/student/mainpage" >Room Booking</a></li>
                <li><a href="/student/student-status" class="active">Status</a></li>
                <li><a href="/student/history-stu">History</a></li>
              <li>
                <form id="logout-form">
                  <button class="gradient-button-logout" type="button" onclick="logout()" style="text-decoration: none; color: #DE2020;">
                      <div style="padding:0px;">
                          <img id="btnlogout" src="/public/img/sign in.png" alt="Log out" style="width: 30px; height:40px;"> 
                          Log Out
                      </div>
                  </button>
              </form>

              </li>
            </ul>
            <a class='menu-trigger'>
              <span>Menu</span>
            </a>


            <!-- ***** Menu End ***** -->
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

    

  <div class="container-stu">
    <h3 class="status-title text-center">Booking Status</h3>
    <div class="row p-5" id="bookingContainer">
        <!-- Cards will be inserted here dynamically -->
    </div>
</div>

<script>

document.addEventListener("DOMContentLoaded", function() {
    // Function to determine the image path based on the room type
    function getImagePath(roomType) {
        if (roomType.includes('Multimedia')) return '/public/img/mul-1.jpg';
        if (roomType.includes('Big Study')) return '/public/img/rb-1.jpg';
        if (roomType.includes('Small Study')) return '/public/img/rs-1.jpg';
        return '/public/img/default.jpg'; // Default image if no match
    }

    // Function to create card elements and insert them into the DOM
    function createBookingCards(bookingsData) {
        const container = document.getElementById('bookingContainer');
        container.innerHTML = ''; // Clear existing contents

        bookingsData.forEach(booking => {
            const status = booking.booking_status ?? 'unknown'; // Fixed property access
            const col = document.createElement('div');
            col.className = 'col-md-4';
            col.innerHTML = `
                <div class="card">
                    <img src="${getImagePath(booking.room_name)}" class="card-img-top" alt="Image for ${booking.room_name}">
                    <div class="card-body">
                        <h5 class="card-title">${booking.room_name}</h5>
                        <p class="card-text">Booking Date: ${booking.booking_date}</p>
                        <p class="card-text">Booking Time: ${booking.time_slot}</p>
                        <span class="status-badge" style="background-color: ${
                            status === 'approved' ? '#a8f4c4' :
                            status === 'pending' ? '#f4eaa9' :
                            '#f4a8b3'
                        }">${status.charAt(0).toUpperCase() + status.slice(1)}</span>
                    </div>
                </div>
            `;
            container.appendChild(col);
        });
    }

    // Fetching bookings data from the server
    fetch('/student/bookings')
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            if (data.length === 0) {
                throw new Error('No booking data found');
            }
            createBookingCards(data);
        })
        .catch(error => {
            console.error('Error fetching booking data:', error);
            const container = document.getElementById('bookingContainer');
            container.innerHTML = `<p class="text-center text-white">Failed to load booking data: ${error.message}</p>`;
        });
});
</script>

  <!-- ________________________JS Script____________________________ -->

  <script src="/public/jquery/jquery.min.js"></script>
  <script src="/public/bootstrap/js/bootstrap.min.js"></script>
  <script src="/public/js/animation.js"></script>
  <script src="/public/js/popup.js"></script>
  <script src="/public/bootstrap/js/sweetalert2@11.js"></script>
  <script src="/public/js/index.js"></script>

<!-- ________________________End of JS Script_______________________ -->

</html>
